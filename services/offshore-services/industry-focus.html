<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Industry-Focus | Nichi-In Software Solutions</title>

    <!-- Fonts -->
    <link rel="icon" type="image/png" href="/assets/img/favicon.png">
    <html-include src="/layout/script.html" lang="en"></html-include>
    <link rel="stylesheet" href="/assets/css/global.css">  

</head>
<body>
    <!-- Header will load here -->
    <html-include src="/layout/header.html" lang="en"></html-include>
    <div id="content">

    <main>
        <!-- Industry Slider Section -->
        <div class="slider-container">
            <div class="slider-wrapper">
                <div class="progress-bar"></div>
                <div class="progress-counter">
                    <span>0%</span>
                </div>

                <div class="scroller">
                    <!-- Industry Slides -->
                    <section class="industry-slide" data-index="0">
                        <h1 class="main-heading">Industry Focus</h1>
                        <h2>Manufacturing</h2>
                    </section>
                    <section class="industry-slide" data-index="1">
                        <h1 class="main-heading">Industry Focus</h1>
                        <h2>Retail</h2>
                    </section>
                    <section class="industry-slide" data-index="2">
                        <h1 class="main-heading">Industry Focus</h1>
                        <h2>Automotive</h2>
                    </section>
                    <section class="industry-slide" data-index="3">
                        <h1 class="main-heading">Industry Focus</h1>
                        <h2>Healthcare</h2>
                    </section>
                    <section class="industry-slide" data-index="4">
                        <h1 class="main-heading">Industry Focus</h1>
                        <h2>Fintech</h2>
                    </section>
                    <section class="industry-slide" data-index="5">
                        <h1 class="main-heading">Industry Focus</h1>
                        <h2>Education</h2>
                    </section>
                    <section class="industry-slide" data-index="6">
                        <h1 class="main-heading">Industry Focus</h1>
                        <h2>Travel & Tourism</h2>
                    </section>
                </div>

                <div class="pagination-dots">
                    <!-- Dots will be dynamically generated by JavaScript -->
                </div>
            </div>
        </div>

        <!-- Verticals Section -->
        <section class="verticals-section common-padding">
            <h2 class="verticals-title section-title">Verticals</h2>
            <p class="verticals-intro">
                Nichi-In Software has acquired requisite experience
                over the years by serving different industry verticals
                with a customer centric approach.
            </p>    

            <div class="vertical-item">
                <div class="vertical-header">Manufacturing</div>
                <div class="vertical-content">
                    <p>We collaborate with industrial manufacturers,
                    both SMEs and large enterprises, to achieve their
                    business objectives such as cost reduction.</p>
                </div>
            </div>

            <div class="vertical-item">
                <div class="vertical-header">Retail</div>
                <div class="vertical-content">
                    <p>Nichi-In Software has offered a wide variety of Web 2.0
                    application services for retailers including website design.</p>
                </div>
            </div>

            <div class="vertical-item">
                <div class="vertical-header">Automotive</div>
                <div class="vertical-content">
                    <p>We have collaborated with automotive companies in providing
                    traditional custom enterprise solutions as well as migration.</p>
                </div>
            </div>

            <div class="vertical-item">
                <div class="vertical-header">Healthcare</div>
                <div class="vertical-content">
                    <p>We have provided customized software development, digital
                    marketing and other services.</p>
                </div>
            </div>

            <div class="vertical-item">
                <div class="vertical-header">Fintech</div>
                <div class="vertical-content">
                    <p>Our offshore and onsite teams have served financial stocks
                    and securities companies for a long period of time now.</p>
                </div>
            </div>

            <div class="vertical-item">
                <div class="vertical-header">Education</div>
                <div class="vertical-content">
                    <p>Nichi-In Software has expertise in education sector across
                    both Japan and US, having developed several school management systems and service applications.</p>
                </div>
            </div>

            <div class="vertical-item">
                <div class="vertical-header">Travel & Tourism</div>
                <div class="vertical-content">
                    <p>Nichi-In Software has rich experience in developing
                    innovative travel and tourism apps that enhance user experience through seamless
                    travel planning of historical and archaeological places.</p>
                </div>
            </div>
        </section>
    </main>
    </div>

    <html-include src="/layout/footer.html" lang="en"></html-include>
    <script src="/assets/js/main.js"></script>
    <script src="/backup/draft.js"></script>

    <!-- Custom JS for the page (e.g., slider and accordion logic) -->
    <script>
        // Industry Slider Script
        document.addEventListener("DOMContentLoaded", () => {
            const container = document.querySelector(".slider-wrapper");
            const scroller = document.querySelector(".scroller");
            const progressCounterSpan = document.querySelector(".progress-counter span");
            const progressBar = document.querySelector(".progress-bar");
            const paginationDotsContainer = document.querySelector(".pagination-dots");
            const industrySlides = Array.from(document.querySelectorAll(".industry-slide"));

            const smoothFactor = 0.08;
            const touchSensitivity = 2.5;
            const autoplayDelay = 3000; // 3 seconds for autoplay
            const pauseAutoplayDuration = 5000; // 5 seconds pause after interaction

            let targetScrollX = 0;
            let currentScrollX = 0;
            let isAnimating = false;
            let currentProgressScale = 0;
            let targetProgressScale = 0;
            let autoplayInterval;
            let autoplayTimeoutId;

            let slideWidth;
            let maxScrollX;

            /**
             * Recalculates the width of slides and the maximum scrollable area.
             */
            const recalculateWidths = () => {
                slideWidth = window.innerWidth;
                scroller.style.width = `calc(${industrySlides.length} * 100vw + 1px)`;
                maxScrollX = (industrySlides.length - 1) * slideWidth;
            };

            /**
             * Linear interpolation function.
             * @param {number} start - The starting value.
             * @param {number} end - The ending value.
             * @param {number} factor - The interpolation factor (0-1).
             * @returns {number} The interpolated value.
             */
            const lerp = (start, end, factor) => start + (end - start) * factor;

            /**
             * Clamps a value between a minimum and maximum.
             * @param {number} value - The value to clamp.
             * @param {number} min - The minimum allowed value.
             * @param {number} max - The maximum allowed value.
             * @returns {number} The clamped value.
             */
            const clamp = (value, min, max) => Math.max(min, Math.min(value, max));

            /**
             * Sets up the pagination dots dynamically based on the number of slides.
             */
            const setupPagination = () => {
                paginationDotsContainer.innerHTML = ""; // Clear existing dots
                industrySlides.forEach((_, index) => {
                    const dot = document.createElement("div");
                    dot.classList.add("pagination-dot");
                    dot.dataset.index = index;
                    dot.addEventListener("click", () => {
                        stopAutoplay(); // Stop autoplay on manual interaction
                        targetScrollX = clamp(index * slideWidth, 0, maxScrollX);
                        if (!isAnimating) {
                            isAnimating = true;
                            requestAnimationFrame(animate);
                        }
                        restartAutoplayWithDelay(); // Restart autoplay after a delay
                    });
                    paginationDotsContainer.appendChild(dot);
                });
            };

            /**
             * Updates the UI elements like progress bar, counter, and active dot.
             */
            const updateUI = () => {
                const percentage = maxScrollX === 0 ? 0 : (currentScrollX / maxScrollX) * 100;
                targetProgressScale = percentage / 100;
                progressCounterSpan.textContent = `${Math.round(percentage)}%`;

                currentProgressScale = lerp(currentProgressScale, targetProgressScale, smoothFactor);
                progressBar.style.transform = `scaleX(${currentProgressScale})`;

                const dots = Array.from(paginationDotsContainer.children);
                const activeIndex = Math.round(currentScrollX / slideWidth);
                dots.forEach((dot, index) =>
                    dot.classList.toggle("is-active", index === activeIndex)
                );

                industrySlides.forEach((slide, index) =>
                    slide.classList.toggle("is-active", index === activeIndex)
                );
            };

            /**
             * Animation loop for smooth scrolling.
             */
            const animate = () => {
                currentScrollX = lerp(currentScrollX, targetScrollX, smoothFactor);
                currentScrollX = clamp(currentScrollX, 0, maxScrollX);

                scroller.style.transform = `translateX(-${currentScrollX}px)`;
                updateUI();

                if (Math.abs(targetScrollX - currentScrollX) > 0.1) {
                    requestAnimationFrame(animate);
                } else {
                    currentScrollX = targetScrollX; // Snap to target if very close
                    scroller.style.transform = `translateX(-${currentScrollX}px)`;
                    isAnimating = false;
                }
            };

            /**
             * Starts the autoplay interval for slides.
             */
            const startAutoplay = () => {
                stopAutoplay(); // Clear any existing autoplay
                autoplayInterval = setInterval(() => {
                    let nextIndex = Math.round(targetScrollX / slideWidth) + 1;
                    if (nextIndex >= industrySlides.length) {
                        nextIndex = 0; // Loop back to the first slide
                    }
                    targetScrollX = clamp(nextIndex * slideWidth, 0, maxScrollX);
                    if (!isAnimating) {
                        isAnimating = true;
                        requestAnimationFrame(animate);
                    }
                }, autoplayDelay);
            };

            /**
             * Stops the current autoplay interval and timeout.
             */
            const stopAutoplay = () => {
                clearInterval(autoplayInterval);
                clearTimeout(autoplayTimeoutId);
            };

            /**
             * Restarts autoplay after a specified pause duration.
             */
            const restartAutoplayWithDelay = () => {
                stopAutoplay();
                autoplayTimeoutId = setTimeout(startAutoplay, pauseAutoplayDuration);
            };

            // Touch interaction variables
            let isDown = false;
            let startX;
            let scrollLeft;
            let velocity = 0;
            let lastMoveTime = 0;
            // let initialTargetScrollX = 0; // Not used currently, can be removed if not needed for future features

            container.addEventListener("touchstart", (e) => {
                stopAutoplay(); // Pause autoplay on touch start
                isDown = true;
                startX = e.touches[0].clientX;
                scrollLeft = currentScrollX;
                // initialTargetScrollX = targetScrollX; // Not used currently
                velocity = 0;
                lastMoveTime = Date.now();
                cancelAnimationFrame(animate); // Stop ongoing animation for direct manipulation
            }, { passive: false }); // Use passive: false to allow preventDefault

            container.addEventListener("touchmove", (e) => {
                if (!isDown) return;
                e.preventDefault(); // Prevent scrolling the entire page

                const x = e.touches[0].clientX;
                const deltaX = x - startX;
                const walk = deltaX * touchSensitivity; // Adjust sensitivity as needed

                const now = Date.now();
                const deltaTime = now - lastMoveTime;

                if (deltaTime > 0) {
                    velocity = walk / deltaTime; // Calculate velocity
                }
                lastMoveTime = now;

                targetScrollX = clamp(scrollLeft - walk, 0, maxScrollX);
                if (!isAnimating) {
                    isAnimating = true;
                    requestAnimationFrame(animate);
                }
            }, { passive: false }); // Use passive: false to allow preventDefault

            container.addEventListener("touchend", () => {
                isDown = false;

                // Apply momentum or snap to nearest slide
                if (Math.abs(velocity) > 0.1) {
                    let momentumTarget = targetScrollX - velocity * 100; // Apply some momentum
                    const nearestSlideIndex = Math.round(momentumTarget / slideWidth);
                    targetScrollX = clamp(nearestSlideIndex * slideWidth, 0, maxScrollX);
                } else {
                    // Snap to the nearest slide if no significant velocity
                    const nearestSlideIndex = Math.round(currentScrollX / slideWidth);
                    targetScrollX = clamp(nearestSlideIndex * slideWidth, 0, maxScrollX);
                }

                if (!isAnimating) {
                    isAnimating = true;
                    requestAnimationFrame(animate);
                }
                restartAutoplayWithDelay(); // Restart autoplay after interaction
            });

            // Initialize slider on window load
            window.addEventListener("load", () => {
                recalculateWidths();
                setupPagination();
                updateUI();
                startAutoplay();
            });

            // Handle window resize
            window.addEventListener("resize", () => {
                // Preserve current slide position relative to total scroll
                const scrollRatio = maxScrollX === 0 ? 0 : targetScrollX / maxScrollX;
                recalculateWidths(); // Recalculate widths based on new window size
                const newTargetIndex = Math.round(scrollRatio * (industrySlides.length - 1));
                targetScrollX = clamp(newTargetIndex * slideWidth, 0, maxScrollX);
                currentScrollX = clamp(targetScrollX, 0, maxScrollX);
                scroller.style.transform = `translateX(-${currentScrollX}px)`; // Immediately update position
                stopAutoplay(); // Stop autoplay during resize
                updateUI(); // Update UI elements
                startAutoplay(); // Restart autoplay after resize
            });

            // Verticals Section Script (Accordion)
            const verticalHeaders = document.querySelectorAll('.vertical-header');

            verticalHeaders.forEach(header => {
                header.addEventListener('click', () => {
                    const content = header.nextElementSibling;
                    const isActive = header.classList.contains('active');

                    // Close all other open items
                    document.querySelectorAll('.vertical-content.show').forEach(openContent => {
                        if (openContent !== content) {
                            openContent.classList.remove('show');
                            openContent.previousElementSibling.classList.remove('active');
                        }
                    });

                    // Toggle current item
                    header.classList.toggle('active');
                    content.classList.toggle('show');
                });
            });
        });
    </script>
    <!-- Include draft.js for mobile navigation if it contains initMobileNavigation -->
    <script src="../../assets/js/draft.js"></script>
</body>
</html>